<?php


namespace WPPluginCore\Persistence\Domain\Entity\Attribute\Implementation;

use WPPluginCore\Exception\AttributeException;
use WPPluginCore\Persistence\Domain\Entity\Attribute\Abstraction\Attribute;

use \DateTime;
defined('ABSPATH') || exit;

class StartMonth extends Date
{

    /**
     * @inheritDoc
     */
    public function __construct(string $key, string $label)
    {
        parent::__construct($key, $label, \WPPluginCore\Service\Date::DATE_MONTH);
    }

    /**
     * @inheritDoc
     */
    public function loadFromPost() : void
    {
        if (isset($_POST[ $this->key ])) {
            $this->setValue($_POST[ $this->key ] . '-01');
        } else {
            throw new AttributeException('The Value of ' . $this->label . ' not set in POST variable');
        }
    }
    /**
     * @inheritDoc
     */
    public function getDefault()
    {
        return \WPPluginCore\Service\Date::getInstance()->getFirstOfCurrentMonth();
    }

    /**
     * @inheritDoc
     */
    public function validateValue($value): bool
    {
        return parent::validateValue($value) && $value->format('d') == '01'; // TODO: Change the autogenerated stub
    }


}
